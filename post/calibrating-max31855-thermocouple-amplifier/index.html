<!doctype html><html class=no-js lang=en-us xmlns=http://www.w3.org/1999/xhtml xml:lang=en lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Calibrating MAX31855 Thermocouple Amplifier"><meta name=author content><meta name=keyword content><link rel="shortcut icon" href=/favicon.ico><title>Calibrating MAX31855 Thermocouple Amplifier &#183; Spaghetti Code with Beer</title><link rel=stylesheet href=https://nagimov.me/css/theme/united2.css><link rel=stylesheet href=https://nagimov.me/css/font-awesome.min.css><link rel=stylesheet href=https://nagimov.me/css/style.css><script>var remark_config={host:"https://remark.ngm.me",site_id:'nagimov_me',components:['embed'],theme:'light',};</script><script>!function(e,n){for(var o=0;o<e.length;o++){var r=n.createElement("script"),c=".js",d=n.head||n.body;"noModule"in r?(r.type="module",c=".mjs"):r.async=!0,r.defer=!0,r.src=remark_config.host+"/web/"+e[o]+c,d.appendChild(r)}}(remark_config.components||["embed"],document);</script><script>(function(f,a,t,h,o,m){a[h]=a[h]||function(){(a[h].q=a[h].q||[]).push(arguments)};o=f.createElement('script'),m=f.getElementsByTagName('script')[0];o.async=1;o.src=t;o.id='fathom-script';m.parentNode.insertBefore(o,m)})(document,window,'https://fathom.ngm.me/tracker.js','fathom');fathom('set','siteId','RYEFY');fathom('trackPageview');</script><link href rel=alternate type=application/rss+xml title="Spaghetti Code with Beer"></head><body lang=en><div class=container><div class=row><div class="navbar navbar-default" role=navigation><div class=navbar-header><a class=navbar-brand href=https://nagimov.me>Spaghetti Code with Beer</a></div><div class="navbar-collapse collapse navbar-responsive-collapse"><ul class="nav navbar-nav navbar-right" style=font-size:18px><li><a href=https://nagimov.me>Home</a></li><li><a href=https://nagimov.me/post/>Posts</a></li><li><a href=/about/>About</a></li></ul></div></div></div></div><div class=container><div class=row><div class=col-md-12 style=display:flex;justify-content:space-between><div><h3>Calibrating MAX31855 Thermocouple Amplifier</h3></div><div>&nbsp;&nbsp;&nbsp;&nbsp;</div><div style=margin-bottom:10.5px;margin-top:21px><span class="label label-primary">2016-08-15</span></div></div></div><div class=row><div class=col-md-12><p><img src=/images/calibrating-max31855-thermocouple-amplifier/MAX31855-K-Type-Thermocouple-Breakout-Board.png#floatright alt=width300px></p><p><a href=https://www.maximintegrated.com/en/products/interface/sensor-interface/MAX31855.html>Maxim 31855 chips</a> are cheap and simple to use K-type thermocouple amplifiers. They&rsquo;re equipped with a digital SPI interface with libraries available for both Raspberry Pi and Arduino boards. MAX31855 breakout boards are <a href=https://www.adafruit.com/product/269>available from Adafruit</a>.</p><p><a href=https://datasheets.maximintegrated.com/en/ds/MAX31855.pdf>The datasheet</a> specifies the accuracy of ±2°C within the temperature range from -200°C to +700°C. However, close to the lower bound of this range, the accuracy of reported temperature is affected by linearized volt-to-degree conversion. Maxim 31855 uses a conversion factor of 0.041276 mV/K to calculate the difference between temperatures of the reference junction and the thermocouple. This known conversion factor can be used to recalculate the voltage and recalibrate the temperature via <a href=http://srdata.nist.gov/its90/download/type_k.tab>NIST formulations</a> to achieve a better accuracy when measuring thermocouples used at liquid nitrogen temperatures.</p><p><a href="https://forums.adafruit.com/viewtopic.php?f=19&t=32086&start=45">This adafruit forum thread</a> contains all the necessary information and code for Arduino-compatible boards. A simple python implementation of the recalibration routine is as follows:</p><div class=highlight><pre style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#007020;font-weight:700>import</span> <span style=color:#0e84b5;font-weight:700>numpy</span> <span style=color:#007020;font-weight:700>as</span> <span style=color:#0e84b5;font-weight:700>np</span>

<span style=color:#007020;font-weight:700>def</span> <span style=color:#06287e>nist_tc</span>(tc, cj):  <span style=color:#60a0b0;font-style:italic># tc - thermocouple, cj - cold junction</span>
    dV <span style=color:#666>=</span> (tc <span style=color:#666>-</span> cj) <span style=color:#666>*</span> <span style=color:#40a070>0.041276</span>
    <span style=color:#007020;font-weight:700>if</span> <span style=color:#666>-</span><span style=color:#40a070>5.891</span> <span style=color:#666>&lt;</span> dV <span style=color:#666>&lt;=</span> <span style=color:#40a070>0</span>:
        d <span style=color:#666>=</span> [<span style=color:#40a070>0.0000000E+00</span>, <span style=color:#40a070>2.5173462E+01</span>, <span style=color:#666>-</span><span style=color:#40a070>1.1662878E+00</span>, <span style=color:#666>-</span><span style=color:#40a070>1.0833638E+00</span>,
            <span style=color:#666>-</span><span style=color:#40a070>8.9773540E-01</span>, <span style=color:#666>-</span><span style=color:#40a070>3.7342377E-01</span>, <span style=color:#666>-</span><span style=color:#40a070>8.6632643E-02</span>, <span style=color:#666>-</span><span style=color:#40a070>1.0450598E-02</span>,
            <span style=color:#666>-</span><span style=color:#40a070>5.1920577E-04</span>, <span style=color:#40a070>0.0000000E+00</span>]
    <span style=color:#007020;font-weight:700>elif</span> <span style=color:#40a070>0</span> <span style=color:#666>&lt;</span> dV <span style=color:#666>&lt;=</span> <span style=color:#40a070>20.644</span>:
        d <span style=color:#666>=</span> [<span style=color:#40a070>0.000000E+00</span>, <span style=color:#40a070>2.508355E+01</span>, <span style=color:#40a070>7.860106E-02</span>, <span style=color:#666>-</span><span style=color:#40a070>2.503131E-01</span>,
            <span style=color:#40a070>8.315270E-02</span>, <span style=color:#666>-</span><span style=color:#40a070>1.228034E-02</span>, <span style=color:#40a070>9.804036E-04</span>, <span style=color:#666>-</span><span style=color:#40a070>4.413030E-05</span>,
            <span style=color:#40a070>1.057734E-06</span>, <span style=color:#666>-</span><span style=color:#40a070>1.052755E-08</span>]
    <span style=color:#007020;font-weight:700>elif</span> <span style=color:#40a070>20.644</span> <span style=color:#666>&lt;</span> dV <span style=color:#666>&lt;</span> <span style=color:#40a070>54.886</span>:
        d <span style=color:#666>=</span> [<span style=color:#666>-</span><span style=color:#40a070>1.318058E+02</span>, <span style=color:#40a070>4.830222E+01</span>, <span style=color:#666>-</span><span style=color:#40a070>1.646031E+00</span>, <span style=color:#40a070>5.464731E-02</span>,
            <span style=color:#666>-</span><span style=color:#40a070>9.650715E-04</span>, <span style=color:#40a070>8.802193E-06</span>, <span style=color:#666>-</span><span style=color:#40a070>3.110810E-08</span>, <span style=color:#40a070>0.000000E+00</span>,
            <span style=color:#40a070>0.000000E+00</span>, <span style=color:#40a070>0.000000E+00</span>]
    <span style=color:#007020;font-weight:700>else</span>:
        <span style=color:#007020;font-weight:700>raise</span> <span style=color:#007020>ValueError</span>(<span style=color:#4070a0>&#39;TC voltage must be in range (-5.891mV, 54.886mV)&#39;</span>)
    dt <span style=color:#666>=</span> np<span style=color:#666>.</span>poly1d(d[::<span style=color:#666>-</span><span style=color:#40a070>1</span>])(dV)
    <span style=color:#007020;font-weight:700>return</span> cj <span style=color:#666>+</span> dt
</code></pre></div><p>The errors of linear temperature conversions are tolerable down to ~0°C:</p><p><img src=/images/calibrating-max31855-thermocouple-amplifier/MAX31855-temperature-error.png#center alt></p><hr></div></div><div class=row><div class=col-md-12 style=display:flex;justify-content:space-between><div>Tagged
#<a href=/tags/python>python</a>
,
#<a href=/tags/thermocouple>thermocouple</a>
,
#<a href=/tags/raspberry-pi>raspberry pi</a>
,
#<a href=/tags/max31855>MAX31855</a>
,
#<a href=/tags/spi>SPI</a>
,
#<a href=/tags/nist>NIST</a></div><div><span class="label label-primary">2016-08-15</span></div></div></div><div class=row><div class=col-md-12><hr></div></div><div class=row><div class=col-md-12><div id=remark42></div></div></div></div><div class=container><div class="row col-md-12"><footer><div class=pull-left><p>&copy; 2021 Ruslan Nagimov ~ Powered By <a href=https://gohugo.io>Hugo</a> ~ <a href=https://creativecommons.org/licenses/by/4.0/>License: CC BY 4.0</a></p></div><div class=pull-right><a href=https://github.com/nagimov target=_blank><i class="fa fa-github-square fa-2x"></i></a></div></footer></div></div></body></html>